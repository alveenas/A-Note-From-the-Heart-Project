<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>A Note From the Heart Project</title>

<!-- Favicon -->
<link rel="icon" href="/favicon.ico">

<style>
  :root{
    --ink:#101024;
    --glass:rgba(255,255,255,.88);
    --card:rgba(255,255,255,.95);
    --shadow:0 18px 55px rgba(0,0,0,.18);
  }

  body{
    margin:0;
    padding:28px 16px 190px;
    font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial;
    text-align:center;
    color:var(--ink);
    overflow-x:hidden;
    background:
      radial-gradient(900px 700px at 20% 0%, rgba(170,205,255,.45), transparent 55%),
      radial-gradient(850px 650px at 85% 10%, rgba(255,170,205,.35), transparent 55%),
      radial-gradient(900px 900px at 50% 120%, rgba(210,255,230,.22), transparent 60%),
      linear-gradient(180deg,#0b1026,#151b3a 35%,#2c2e55 70%,#f7f7ff 140%);
  }

  /* ---------- BACKGROUND LAYERS ---------- */
  .bg-layer{
    position:fixed;
    inset:0;
    pointer-events:none;
  }

  /* twinkling star field */
  .stars1,.stars2,.stars3,.stars4{
    z-index:0;
    background-repeat:repeat;
  }
  .stars1{
    opacity:.7;
    background-image:
      radial-gradient(2px 2px at 20px 30px,#fff 55%,transparent 60%),
      radial-gradient(1.5px 1.5px at 120px 140px,#fff 55%,transparent 60%),
      radial-gradient(1.8px 1.8px at 240px 80px,#fff 55%,transparent 60%),
      radial-gradient(1.2px 1.2px at 340px 190px,#fff 55%,transparent 60%);
    background-size:760px 320px;
    animation:twinkle 5s ease-in-out infinite;
  }
  .stars2{
    opacity:.5;
    background-image:
      radial-gradient(1.2px 1.2px at 60px 200px,#fff 55%,transparent 60%),
      radial-gradient(1.3px 1.3px at 300px 120px,#fff 55%,transparent 60%),
      radial-gradient(1.1px 1.1px at 520px 220px,#fff 55%,transparent 60%);
    background-size:900px 420px;
    animation:twinkle 7s ease-in-out infinite;
  }
  .stars3{
    opacity:.35;
    background-image:
      radial-gradient(2px 2px at 140px 90px,#ffe 55%,transparent 60%),
      radial-gradient(1.7px 1.7px at 520px 210px,#fac 55%,transparent 60%),
      radial-gradient(1.4px 1.4px at 620px 90px,#fff 55%,transparent 60%);
    background-size:1000px 520px;
    animation:twinkle 9s ease-in-out infinite;
  }
  .stars4{
    opacity:.25;
    background-image:
      radial-gradient(1px 1px at 40px 40px,#fff 55%,transparent 65%),
      radial-gradient(1px 1px at 180px 90px,#fff 55%,transparent 65%),
      radial-gradient(1px 1px at 260px 160px,#fff 55%,transparent 65%),
      radial-gradient(1px 1px at 420px 140px,#fff 55%,transparent 65%);
    background-size:820px 360px;
    animation:twinkle 4s ease-in-out infinite;
  }
  @keyframes twinkle{50%{opacity:.95}}

  /* Constellations (background SVG layer) */
  .constellations{
    z-index:1;
    opacity:.55;
  }
  .constellations svg{
    width:100%;
    height:220px;
    display:block;
    filter:drop-shadow(0 10px 30px rgba(0,0,0,.25));
  }
  .const-line{
    stroke:rgba(255,255,255,.35);
    stroke-width:1.4;
    stroke-dasharray:5 10;
    animation:dash 7s linear infinite;
  }
  @keyframes dash{to{stroke-dashoffset:-90}}
  .const-star{
    fill:#fff;
    opacity:.9;
    animation:pulse 3.4s ease-in-out infinite;
  }
  @keyframes pulse{50%{opacity:.55}}

  /* Shooting stars (behind everything) */
  .shooting-stars{
    z-index:2; /* content is z-index 10 */
    overflow:hidden;
  }
  .shooting-stars span{
    position:absolute;
    top:0;
    left:0;
    width:180px;
    height:2px;
    background:linear-gradient(90deg, rgba(255,255,255,0), rgba(255,255,255,.95), rgba(255,255,255,0));
    opacity:.55;
    transform:rotate(-20deg);
    filter:blur(.2px);
    animation:shoot 7s linear infinite;
  }
  .shooting-stars span::after{
    content:"";
    position:absolute;
    right:-10px;
    top:-4px;
    width:10px;
    height:10px;
    background:rgba(255,255,255,.95);
    border-radius:50%;
    filter:blur(1px);
    opacity:.7;
  }
  .shooting-stars span:nth-child(1){ top:12%; left:-30%; animation-delay:0s; animation-duration:8s; }
  .shooting-stars span:nth-child(2){ top:28%; left:-50%; animation-delay:2.2s; animation-duration:9s; }
  .shooting-stars span:nth-child(3){ top:44%; left:-40%; animation-delay:4.2s; animation-duration:8.5s; }
  .shooting-stars span:nth-child(4){ top:18%; left:-60%; animation-delay:5.4s; animation-duration:10s; }

  @keyframes shoot{
    0%   { transform:translateX(-30vw) translateY(0) rotate(-20deg); opacity:0; }
    8%   { opacity:.55; }
    35%  { opacity:.55; }
    55%  { transform:translateX(160vw) translateY(24vh) rotate(-20deg); opacity:0; }
    100% { opacity:0; }
  }

  /* ---------- CONTENT ---------- */
  .wrap{
    max-width:920px;
    margin:0 auto;
    position:relative;
    z-index:10;
  }

  .header{
    position:relative;
    padding-bottom:10px;
  }

  .heart{
    display:inline-flex;
    align-items:center;
    justify-content:center;
    width:34px;
    height:34px;
    border-radius:999px;
    background:rgba(255,255,255,.18);
    border:1px solid rgba(255,255,255,.25);
    color:#fff;
    font-size:18px;
    margin:0 auto 10px;
    box-shadow:0 12px 35px rgba(0,0,0,.25);
  }

  h1{
    color:#fff;
    font-size:34px;
    margin:0 0 6px;
    text-shadow:0 12px 35px rgba(0,0,0,.4);
    letter-spacing:.2px;
  }

  .tagline{
    color:rgba(255,255,255,.85);
    font-size:15px;
    margin:0 0 6px;
  }

  .mission{
    color:rgba(255,255,255,.92);
    font-size:14px;
    max-width:660px;
    margin:0 auto 16px;
    line-height:1.45;
  }

  .card{
    background:var(--glass);
    border-radius:24px;
    padding:20px;
    box-shadow:var(--shadow);
    border:1px solid rgba(20,20,37,.08);
    backdrop-filter: blur(6px);
  }

  #count{
    font-weight:650;
    margin-bottom:10px;
    color:#15152c;
  }

  #note{
    background:var(--card);
    border-radius:22px;
    padding:22px;
    max-width:720px;
    margin:16px auto;
    text-align:left;
    box-shadow:0 18px 55px rgba(0,0,0,.22);
    border:1px solid rgba(20,20,37,.08);
    position:relative;
    overflow:hidden;
  }

  #note::before{
    content:"";
    position:absolute;
    inset:-2px;
    background:linear-gradient(135deg, rgba(255,255,255,.55), rgba(196,224,255,.32), rgba(255,205,232,.28));
    filter:blur(10px);
    opacity:.35;
    z-index:0;
  }
  #note > *{ position:relative; z-index:1; }

  #note-title{
    font-size:19px;
    margin:0 0 8px;
    color:#121226;
  }
  #note-message{
    font-size:17px;
    line-height:1.65;
    white-space:pre-wrap;
    margin:0;
    color:#1a1a33;
  }

  /* Fade-in for each new note */
  .note-fade{ animation:noteFade .35s ease; }
  @keyframes noteFade{
    from{ opacity:0; transform:translateY(6px); }
    to{ opacity:1; transform:none; }
  }

  .primary-btn{
    display:block;
    margin:14px auto 10px;
    padding:16px 22px;
    font-size:16px;
    font-weight:700;
    border-radius:18px;
    border:none;
    cursor:pointer;
    color:#0b0f22;
    background:linear-gradient(135deg, rgba(255,255,255,.95), rgba(196,224,255,.92), rgba(255,205,232,.88));
    box-shadow:0 16px 40px rgba(0,0,0,.22);
    transition:transform .12s ease, box-shadow .12s ease;
  }
  .primary-btn:hover{
    transform:translateY(-1px);
    box-shadow:0 20px 50px rgba(0,0,0,.26);
  }

  .action-row{
    display:flex;
    justify-content:center;
    flex-wrap:wrap;
    gap:8px;
    margin-bottom:8px;
  }

  .secondary-btn{
    padding:10px 14px;
    border-radius:14px;
    border:1px solid rgba(20,20,37,.12);
    background:rgba(255,255,255,.86);
    cursor:pointer;
    color:#111;
    font-size:14px;
    transition:transform .1s ease;
  }
  .secondary-btn:hover{transform:translateY(-1px)}

  input,textarea{
    width:min(620px,92vw);
    padding:12px 14px;
    margin:8px 0;
    border-radius:14px;
    border:1px solid rgba(0,0,0,.14);
    font-size:15px;
    box-sizing:border-box;
  }
  textarea{min-height:120px;resize:vertical}

  .about{
    display:none;
    text-align:left;
    background:rgba(255,255,255,.9);
    padding:14px;
    border-radius:18px;
    margin:12px auto 0;
    max-width:720px;
    line-height:1.6;
    color:#1a1a33;
    opacity:0;
    transform:translateY(6px);
    transition:opacity .25s ease, transform .25s ease;
  }
  .about.open{opacity:1;transform:none}

  footer{
    margin-top:22px;
    font-size:13px;
    color:rgba(255,255,255,.86);
    line-height:1.65;
    max-width:760px;
    margin-left:auto;
    margin-right:auto;
  }

  /* Crisis support popup */
  #crisis-tab{
    position:fixed;
    bottom:0;
    left:50%;
    transform:translateX(-50%);
    background:rgba(255,255,255,.92);
    color:#111;
    padding:8px 16px;
    border-radius:14px 14px 0 0;
    font-size:13px;
    cursor:pointer;
    z-index:30;
    box-shadow:0 -6px 20px rgba(0,0,0,.2);
    border:1px solid rgba(20,20,37,.12);
  }
  #crisis-popup{
    position:fixed;
    bottom:-120%;
    left:0;
    width:100%;
    background:#fff;
    padding:20px;
    box-shadow:0 -10px 30px rgba(0,0,0,.25);
    transition:bottom .35s ease;
    z-index:35;
    text-align:left;
  }
  #crisis-popup.open{bottom:0}
  #crisis-popup h3{margin-top:0}
  #crisis-popup ul{padding-left:18px}
  #crisis-popup a{color:#1b3cff;text-decoration:none}
  #crisis-popup a:hover{text-decoration:underline}

  @media(max-width:520px){
    body{padding:18px 12px 190px}
    h1{font-size:26px}
    .mission{font-size:13px;padding:0 6px}
    .primary-btn{width:100%}
    .action-row{gap:8px}
    .action-row .secondary-btn{width:100%}
    #note{padding:16px}
    #note-message{font-size:16px}
    .constellations svg{height:170px}
  }
</style>
</head>

<body>

<!-- Background layers -->
<div class="bg-layer stars1"></div>
<div class="bg-layer stars2"></div>
<div class="bg-layer stars3"></div>
<div class="bg-layer stars4"></div>

<div class="bg-layer constellations" aria-hidden="true">
  <svg viewBox="0 0 1200 220" preserveAspectRatio="none">
    <line class="const-line" x1="140" y1="150" x2="240" y2="95"/>
    <line class="const-line" x1="240" y1="95"  x2="340" y2="125"/>
    <line class="const-line" x1="340" y1="125" x2="420" y2="70"/>
    <circle class="const-star" cx="140" cy="150" r="3"/>
    <circle class="const-star" cx="240" cy="95"  r="3.3"/>
    <circle class="const-star" cx="340" cy="125" r="2.8"/>
    <circle class="const-star" cx="420" cy="70"  r="3.4"/>

    <line class="const-line" x1="760" y1="155" x2="840" y2="110"/>
    <line class="const-line" x1="840" y1="110" x2="930" y2="140"/>
    <line class="const-line" x1="930" y1="140" x2="1010" y2="90"/>
    <circle class="const-star" cx="760" cy="155" r="3"/>
    <circle class="const-star" cx="840" cy="110" r="3.2"/>
    <circle class="const-star" cx="930" cy="140" r="2.7"/>
    <circle class="const-star" cx="1010" cy="90" r="3.5"/>

    <line class="const-line" x1="560" y1="90" x2="600" y2="60"/>
    <line class="const-line" x1="600" y1="60" x2="650" y2="80"/>
    <circle class="const-star" cx="560" cy="90" r="2.6"/>
    <circle class="const-star" cx="600" cy="60" r="3"/>
    <circle class="const-star" cx="650" cy="80" r="2.6"/>
  </svg>
</div>

<div class="bg-layer shooting-stars" aria-hidden="true">
  <span></span><span></span><span></span><span></span>
</div>

<div class="wrap">
  <div class="header">
    <div class="heart" aria-hidden="true">♥</div>
    <h1>A Note From the Heart Project</h1>
    <p class="tagline">A little spark for the nights that feel heavy.</p>
    <p class="mission">A place where strangers can leave a gentle note to light up someone's day :)</p>
  </div>

  <div class="card">
    <div id="count"></div>

    <div id="note">
      <h2 id="note-title">Loading a note…</h2>
      <p id="note-message">One moment.</p>
    </div>

    <button class="primary-btn" onclick="getNote()">Receive a Random Note</button>

    <div class="action-row">
      <button class="secondary-btn" onclick="reportNote()">Report</button>
      <button class="secondary-btn" onclick="toggleAbout()">About</button>
      <button class="secondary-btn" onclick="openFeedback()">Note to the Creator</button>
    </div>

    <div id="about" class="about">
      <p>
        I made this because sometimes you are not looking for advice.
        You are just hoping for reassurance.
        A small reminder that someone out there cares.
      </p>
      <p>
        According to the CDC, about 40 percent of U.S. high school students have reported
        feeling persistently sad or hopeless in recent years.
        Support systems are not always easy to find.
      </p>
      <p>
        This space exists to make those moments feel a little less lonely.
        A gentle note from someone you’ve never met.
      </p>
    </div>

    <h3 style="margin-top:18px">Leave a note</h3>
    <input id="title" placeholder="Title">
    <input id="website" style="display:none">
    <textarea id="message" placeholder="Your message (under 500 words)"></textarea><br>
    <button class="secondary-btn" onclick="submitNote()">Submit</button>
  </div>

  <footer>
    This space is meant to be gentle.
    Notes are anonymous and shared with care.
    Reporting exists to protect the community.
    You are welcome here.
  </footer>
</div>

<div id="crisis-tab" onclick="toggleCrisis()">Need help now?</div>
<div id="crisis-popup" aria-live="polite">
  <h3>You deserve support</h3>
  <p>If you’re in immediate danger, call your local emergency number. If you need someone right now, try:</p>
  <ul>
    <li><strong>USA & Canada:</strong> Call or text <b>988</b></li>
    <li><strong>UK & ROI:</strong> Samaritans – <b>116 123</b></li>
    <li><strong>Australia:</strong> Lifeline – <b>13 11 14</b></li>
    <li><strong>India:</strong> AASRA – <b>91-9820466726</b></li>
    <li><strong>Worldwide:</strong> <a href="https://findahelpline.com" target="_blank" rel="noopener">findahelpline.com</a></li>
  </ul>
  <button class="secondary-btn" onclick="toggleCrisis()">Close</button>
</div>

<script>
  let currentId = null;

  function fadeNote(){
    const note = document.getElementById("note");
    note.classList.remove("note-fade");
    void note.offsetWidth;
    note.classList.add("note-fade");
  }

  function getNote(){
    fetch("/random")
      .then(r => r.json())
      .then(d => {
        currentId = d.id;
        document.getElementById("note-title").innerText = d.title;
        document.getElementById("note-message").innerText = d.message;
        fadeNote();
      })
      .catch(() => {
        document.getElementById("note-title").innerText = "Could not load a note";
        document.getElementById("note-message").innerText = "Please refresh and try again.";
      });
  }

  function submitNote(){
    fetch("/submit",{
      method:"POST",
      headers:{ "Content-Type":"application/json" },
      body:JSON.stringify({
        title: document.getElementById("title").value,
        message: document.getElementById("message").value,
        website: document.getElementById("website").value
      })
    }).then(res => {
      if(!res.ok) throw new Error("submit failed");
      document.getElementById("title").value = "";
      document.getElementById("message").value = "";
      loadCount();
      alert("Your note was sent. Thank you for being here.");
    }).catch(() => {
      alert("Something went wrong while sending. Please try again.");
    });
  }

  function reportNote(){
    if(!currentId) return;
    if(!confirm("Are you sure you want to report this note?\nOnly report if it is harmful or inappropriate.")) return;

    fetch("/report",{
      method:"POST",
      headers:{ "Content-Type":"application/json" },
      body:JSON.stringify({ noteId: currentId })
    }).then(() => getNote());
  }

  function toggleAbout(){
    const a = document.getElementById("about");
    if(a.style.display === "block"){
      a.classList.remove("open");
      setTimeout(() => a.style.display = "none", 200);
    }else{
      a.style.display = "block";
      requestAnimationFrame(() => a.classList.add("open"));
    }
  }

  function openFeedback(){
    const msg = prompt("Leave a note or feedback for the creator.");
    if(!msg) return;
    fetch("/feedback",{
      method:"POST",
      headers:{ "Content-Type":"application/json" },
      body:JSON.stringify({ message: msg })
    }).then(() => {
      alert("Sent. Thank you for taking the time to write.");
    }).catch(() => {
      alert("Could not send right now. Please try again.");
    });
  }

  function toggleCrisis(){
    document.getElementById("crisis-popup").classList.toggle("open");
  }

  function loadCount(){
    fetch("/count")
      .then(r => r.json())
      .then(d => {
        document.getElementById("count").innerText = d.total + " notes shared";
      })
      .catch(() => {
        document.getElementById("count").innerText = "";
      });
  }

  loadCount();
  getNote();
</script>

</body>
</html>


