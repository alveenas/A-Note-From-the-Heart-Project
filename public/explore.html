<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Explore â€” A Note From the Heart</title>

<link rel="icon" href="/favicon.ico">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@200;300;400&display=swap" rel="stylesheet">

<style>
:root{
  --red:#b11b3a;
  --navy:#0b1026;
}

body{
  margin:0;
  height:100vh;
  overflow:hidden;
  font-family:"Inter", system-ui, sans-serif;
  font-weight:300;
  color:white;
  background:
    radial-gradient(circle at top, #b11b3a 0%, #0b1026 70%);
}

/* STARFIELD */
.starfield{
  position:fixed;
  inset:0;
  pointer-events:none;
  z-index:0;
}

.star{
  position:absolute;
  color:white;
  font-size:10px;
  opacity:.25;
  animation:twinkle 5s infinite ease-in-out;
}

.big-star{
  font-size:16px;
  opacity:.6;
  animation:sparkle 3s infinite ease-in-out;
}

@keyframes twinkle{
  0%{opacity:.2}
  50%{opacity:.6}
  100%{opacity:.3}
}

@keyframes sparkle{
  0%{opacity:.4; transform:scale(1)}
  50%{opacity:1; transform:scale(1.4)}
  100%{opacity:.5; transform:scale(1)}
}

/* TOP BAR */
.top-bar{
  position:absolute;
  top:14px;
  left:50%;
  transform:translateX(-50%);
  display:flex;
  flex-direction:column;
  align-items:center;
  gap:6px;
  z-index:20;
}

.nav-row{
  display:flex;
  gap:14px;
}

.nav-btn{
  padding:8px 20px;
  border:1px solid rgba(255,255,255,.4);
  border-radius:999px;
  background:rgba(255,255,255,.08);
  color:white;
  letter-spacing:.25em;
  font-size:11px;
  cursor:pointer;
}

#count{
  font-size:11px;
  letter-spacing:.3em;
  opacity:.7;
}

/* LAYOUT */
.wrap{
  position:relative;
  z-index:10;
  height:100%;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  gap:14px;
  text-align:center;
  padding:10px;
}

/* FILTERS */
.filters{
  display:flex;
  gap:6px;
  flex-wrap:wrap;
  justify-content:center;
}

.filter{
  padding:5px 12px;
  border:1px solid rgba(255,255,255,.4);
  border-radius:999px;
  cursor:pointer;
  font-size:11px;
  opacity:.6;
}

.filter.active{
  background:white;
  color:#b11b3a;
  opacity:1;
}

/* NOTE CARD */
.note-box{
  width:100%;
  max-width:720px;
  padding:20px;
  background:rgba(255,255,255,.08);
  border:1px solid rgba(255,255,255,.35);
  border-radius:18px;
  box-shadow:0 30px 80px rgba(0,0,0,.6);
  backdrop-filter: blur(6px);
  display:flex;
  flex-direction:column;
  max-height:55vh;
}

.note-title{
  font-size:16px;
  letter-spacing:.2em;
  margin-bottom:6px;
}

.note-date{
  font-size:11px;
  opacity:.6;
  margin-bottom:10px;
}

.note-message{
  font-size:16px;
  line-height:1.6;
  white-space:pre-wrap;
  overflow-y:auto;
  padding-right:6px;
  flex:1;
}

/* ACTIONS */
.actions{
  display:flex;
  gap:10px;
  margin-top:10px;
  flex-wrap:wrap;
  justify-content:center;
}

.main-btn{
  padding:10px 22px;
  border-radius:999px;
  border:1px solid rgba(255,255,255,.45);
  background:rgba(255,255,255,.12);
  color:white;
  font-size:11px;
  letter-spacing:.2em;
  cursor:pointer;
}

.report-btn{
  padding:10px 18px;
  border-radius:999px;
  border:1px solid rgba(255,255,255,.3);
  background:transparent;
  color:white;
  font-size:10px;
  opacity:.6;
}

/* FLOATING HEART */
.float-heart{
  position:absolute;
  color:#ff2f5b;
  font-size:16px;
  animation:floatUp 1.4s ease forwards;
}

@keyframes floatUp{
  to{transform:translateY(-120px) scale(1.5); opacity:0}
}

/* MOBILE EXTRA SAFETY */
@media(max-width:600px){
  .note-box{max-height:50vh}
  .note-message{font-size:15px}
}
</style>
</head>

<body>

<div class="starfield" id="stars"></div>

<div class="top-bar">
  <div class="nav-row">
    <button class="nav-btn" onclick="location.href='home.html'">HOME</button>
    <button class="nav-btn" onclick="location.href='about.html'">ABOUT</button>
  </div>
  <div id="count">LOADING</div>
</div>

<div class="wrap">

  <div class="filters">
    <div class="filter active">all</div>
    <div class="filter">kindness</div>
    <div class="filter">motivational</div>
    <div class="filter">silly</div>
    <div class="filter">love</div>
    <div class="filter">sad</div>
    <div class="filter">hope</div>
  </div>

  <div class="note-box">
    <div class="note-title" id="noteTitle">LOADING</div>
    <div class="note-date" id="noteDate"></div>
    <div class="note-message" id="noteMessage"></div>
  </div>

  <div class="actions">
    <button class="main-btn" onclick="loadNote()">NEW NOTE</button>
    <button class="main-btn" onclick="likeNote()">LIKE â™¥</button>
    <button class="main-btn" onclick="shareNote()">SHARE</button>
    <button class="report-btn" onclick="reportNote()">REPORT</button>
  </div>
</div>

<script>
let currentId=null;
let currentTag="all";

/* STARS */
const symbols=["âœ¦","âœ§","â‹†","Â·"];
for(let i=0;i<120;i++){
  const s=document.createElement("div");
  s.className=Math.random()>.8?"star big-star":"star";
  s.innerText=symbols[Math.floor(Math.random()*symbols.length)];
  s.style.left=Math.random()*100+"%";
  s.style.top=Math.random()*100+"%";
  s.style.animationDelay=Math.random()*6+"s";
  stars.appendChild(s);
}

/* COUNT */
fetch("/count").then(r=>r.json()).then(d=>{
  count.innerText=d.total+" NOTES SHARED";
});

/* FILTERS */
document.querySelectorAll(".filter").forEach(f=>{
  f.onclick=()=>{
    document.querySelectorAll(".filter").forEach(x=>x.classList.remove("active"));
    f.classList.add("active");
    currentTag=f.innerText;
    loadNote();
  };
});

/* LOAD NOTE */
function loadNote(){
  fetch("/random?tag="+currentTag)
    .then(r=>r.json())
    .then(d=>{
      currentId=d.id;
      noteTitle.innerText=d.title||"";
      noteMessage.innerText=d.message||"";
      noteDate.innerText=d.created_at?
        new Date(d.created_at).toLocaleDateString():
        "";
      spawnHearts();
    });
}

/* LIKE */
function likeNote(){
  spawnHearts();
}

/* SHARE */
function shareNote(){
  navigator.clipboard.writeText(
    "A note from a stranger:\n\n"+noteMessage.innerText+
    "\n\nhttps://anotefromtheheart.com"
  );
  alert("Copied to share ðŸ’—");
}

/* REPORT */
function reportNote(){
  if(!currentId) return;
  if(!confirm("Report this note?")) return;
  fetch("/report",{method:"POST",headers:{"Content-Type":"application/json"},
    body:JSON.stringify({noteId:currentId})})
  .then(loadNote);
}

function spawnHearts(){
  for(let i=0;i<3;i++){
    const h=document.createElement("div");
    h.className="float-heart";
    h.innerText="â™¥";
    h.style.left=45+Math.random()*20+"%";
    h.style.top="55%";
    document.body.appendChild(h);
    setTimeout(()=>h.remove(),1400);
  }
}

loadNote();
</script>

</body>
</html>
